<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test de Sonido - Hubdox Chat SDK</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        .feature {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 5px solid #007bff;
        }
        .feature h3 {
            color: #007bff;
            margin-top: 0;
        }
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 15px 0;
        }
        .controls {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        .btn {
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .btn:hover {
            background: #0056b3;
        }
        .btn-success {
            background: #28a745;
        }
        .btn-success:hover {
            background: #218838;
        }
        .btn-warning {
            background: #ffc107;
            color: #212529;
        }
        .btn-warning:hover {
            background: #e0a800;
        }
        .info-box {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 4px solid #2196f3;
        }
        .warning-box {
            background: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 4px solid #ffc107;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîä Test de Sonido</h1>
        
        <div class="feature">
            <h3>üéµ Sistema de Sonido</h3>
            <p>El chat ahora incluye un sistema de sonido que reproduce una notificaci√≥n cuando el bot env√≠a su primer mensaje.</p>
        </div>

        <div class="info-box">
            <h4>üìã Caracter√≠sticas del Sonido</h4>
            <ul>
                <li><strong>Deshabilitado por defecto:</strong> <code>sound: false</code></li>
                <li><strong>Solo en el primer mensaje:</strong> Se reproduce una sola vez por sesi√≥n</li>
                <li><strong>Sonido fijo:</strong> No se puede modificar, es el proporcionado</li>
                <li><strong>Volumen controlado:</strong> Se reproduce al 50% del volumen</li>
                <li><strong>Persistente:</strong> El estado se guarda en cach√©</li>
            </ul>
        </div>

        <div class="warning-box">
            <h4>‚ö†Ô∏è Importante</h4>
            <p>El sonido se reproduce solo cuando <code>sound: true</code> est√° configurado. Por defecto est√° deshabilitado.</p>
        </div>

        <div class="feature">
            <h3>üîß Configuraci√≥n</h3>
            <div class="code-block">
const chat = new ChatBot({
  // ... configuraci√≥n b√°sica
  custom: {
    // ... otras opciones
    sound: true,  // Habilitar sonido
    // sound: false, // Deshabilitar sonido (por defecto)
  }
});
            </div>
        </div>

        <div class="controls">
            <h3>üéÆ Controles de Prueba</h3>
            <button class="btn" onclick="initChatWithSound()">üîä Chat con Sonido</button>
            <button class="btn btn-warning" onclick="initChatWithoutSound()">üîá Chat sin Sonido</button>
            <button class="btn btn-success" onclick="clearCache()">üóëÔ∏è Limpiar Cach√©</button>
            <button class="btn" onclick="showStatus()">üìä Ver Estado</button>
        </div>

        <div class="feature">
            <h3>üéµ Informaci√≥n del Sonido</h3>
            <p><strong>URL del sonido:</strong> <code>https://res.cloudinary.com/dhqqkf4hy/video/upload/v1754209978/new-notification-010-352755_jjgjfu.mp3</code></p>
            <p><strong>Atribuci√≥n requerida:</strong> Sound Effect by <a href="https://pixabay.com/es/users/universfield-28281460/?utm_source=link-attribution&utm_medium=referral&utm_campaign=music&utm_content=352755">Universfield</a> from <a href="https://pixabay.com/sound-effects//?utm_source=link-attribution&utm_medium=referral&utm_campaign=music&utm_content=352755">Pixabay</a></p>
        </div>

        <div class="feature">
            <h3>üîç C√≥mo Probar</h3>
            <ol>
                <li>Haz clic en "Chat con Sonido" para habilitar el sonido</li>
                <li>Abre el chat y espera el primer mensaje del bot</li>
                <li>Deber√≠as escuchar la notificaci√≥n</li>
                <li>Los mensajes siguientes no tendr√°n sonido</li>
                <li>Usa "Limpiar Cach√©" para resetear y probar nuevamente</li>
            </ol>
        </div>

        <!-- Chat Bot -->
        <script src="../src/index.js"></script>
        <script>
            let chat;

            function initChatWithSound() {
                if (chat) {
                    chat.destroy();
                }
                
                chat = new ChatBot({
                    baseUrl: 'https://hubdocs.test',
                    apiKey: 'test-key',
                    tenant: 'test',
                    user: {
                        name: 'Test User',
                        email: 'test@example.com'
                    },
                    bot: { 
                        name: 'Bot de Test', 
                        img: "../src/img/bot_icon.png"  
                    },
                    options: {
                        show: true,
                        register: false,
                        cache: true,
                        testMode: true,
                        stream: false,
                        devMode: true,
                    },
                    custom: {
                        primaryColor: "#007bff",
                        botName: "Bot de Test",
                        headerBgColor: "#007bff",
                        headerTextColor: "#fff",
                        showTime: true,
                        sound: true, // Habilitar sonido
                        position: {
                            bottom: "24px",
                            right: "24px"
                        }
                    }
                });
                
                console.log('‚úÖ Chat inicializado CON sonido');
                alert('Chat inicializado con sonido habilitado. Abre el chat para escuchar la notificaci√≥n.');
            }

            function initChatWithoutSound() {
                if (chat) {
                    chat.destroy();
                }
                
                chat = new ChatBot({
                    baseUrl: 'https://hubdocs.test',
                    apiKey: 'test-key',
                    tenant: 'test',
                    user: {
                        name: 'Test User',
                        email: 'test@example.com'
                    },
                    bot: { 
                        name: 'Bot de Test', 
                        img: "../src/img/bot_icon.png"  
                    },
                    options: {
                        show: true,
                        register: false,
                        cache: true,
                        testMode: true,
                        stream: false,
                        devMode: true,
                    },
                    custom: {
                        primaryColor: "#007bff",
                        botName: "Bot de Test",
                        headerBgColor: "#007bff",
                        headerTextColor: "#fff",
                        showTime: true,
                        sound: false, // Deshabilitar sonido
                        position: {
                            bottom: "24px",
                            right: "24px"
                        }
                    }
                });
                
                console.log('üîá Chat inicializado SIN sonido');
                alert('Chat inicializado sin sonido. No escuchar√°s notificaciones.');
            }

            function clearCache() {
                if (chat) {
                    chat.clearCache();
                    console.log('üóëÔ∏è Cach√© limpiado');
                    alert('Cach√© limpiado. El sonido se reproducir√° nuevamente en el pr√≥ximo primer mensaje.');
                } else {
                    alert('Primero inicializa un chat');
                }
            }

            function showStatus() {
                if (chat) {
                    const status = `Estado del chat:
Sonido habilitado: ${chat.sound}
Sonido reproducido: ${chat.soundPlayed}
Cach√© habilitado: ${chat.cache}
Modo test: ${chat.testMode}`;
                    
                    alert(status);
                    console.log('üìä Estado del chat:', status);
                } else {
                    alert('Primero inicializa un chat');
                }
            }

            // Inicializar chat sin sonido por defecto
            window.addEventListener('load', () => {
                initChatWithoutSound();
            });
        </script>
    </div>
</body>
</html> 